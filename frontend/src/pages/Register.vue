<template>
  <div class="min-h-screen flex items-center justify-center bg-gray-100">
    <div class="w-full max-w-sm bg-white p-6 rounded-xl shadow-md">
      <h1 class="text-2xl font-bold text-center text-blue-700 mb-5">üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
      <form @submit.prevent="register" class="space-y-4">
        <div>
          <label for="username" class="block text-sm font-medium text-gray-700">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
          <input
            v-model="username"
            type="text"
            id="username"
            placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è"
            class="mt-1 block w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none"
            required
          />
        </div>

        <div>
          <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
          <input
            v-model="email"
            type="email"
            id="email"
            placeholder="example@mail.com"
            class="mt-1 block w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none"
            required
          />
        </div>

        <div>
          <label for="password" class="block text-sm font-medium text-gray-700">–ü–∞—Ä–æ–ª—å</label>
          <input
            v-model="password"
            type="password"
            id="password"
            placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
            class="mt-1 block w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none"
            required
          />
        </div>

        <div>
          <label for="password2" class="block text-sm font-medium text-gray-700">–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
          <input
            v-model="password2"
            type="password"
            id="password2"
            placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
            class="mt-1 block w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none"
            required
          />
        </div>

        <button
          type="submit"
          class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 rounded-lg transition"
        >
          ‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
        </button>
      </form>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'
import { registerUser } from '../api'
import { useRouter } from 'vue-router'

const username = ref('')
const email = ref('')
const password = ref('')
const password2 = ref('') // –¥–æ–±–∞–≤–ª–µ–Ω–æ

const router = useRouter()

async function register() {
  try {
    await registerUser({
      username: username.value,
      email: email.value,
      password: password.value,
      password2: password2.value
    })
    alert('–£—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ!')
    router.push('/login')
  } catch (error) {
    alert('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ' + (error.response?.data?.message || '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ'))
  }
}
</script>
